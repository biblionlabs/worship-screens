import { ViewData, ViewState } from "../api/view-state.slint";

export component View inherits Rectangle {
    in property <float> render-scale: 1.0;
    in property <length> window-width: ViewState.window-width;
    in property <length> window-height: ViewState.window-height;
    in-out property <ViewData> data: {
        show-img: false,
        color: { a: Colors.black, b: Colors.black },
    };

    clip: true;

    property <length> computed-content-fs: data.font.font-size * render-scale;
    property <length> computed-verse-fs: data.verse-font.font-size * render-scale;

    property <length> computed-stroke-width: data.font.stroke-size * render-scale;
    property <length> computed-verse-stroke-width: data.verse-font.stroke-size * render-scale;
    property <length> verse-bottom-offset: 30px * render-scale;

    Rectangle {
        width: parent.width;
        height: parent.height;
        background: @linear-gradient(animation-tick() / 50ms * 1deg, data.color.a, data.color.b);

        animate background { duration: 500ms; }
    }

    if data.show-img: Image {
        width: parent.width;
        height: parent.height;
        image-fit: data.img-fit;
        source: data.img-bg;
    }

    if !data.is-logo: Text {
        width: 100%;
        height: 100%;
        wrap: word-wrap;
        color: data.font.color;
        stroke: data.font.stroke;
        stroke-width: computed-stroke-width;
        stroke-style: outside;
        horizontal-alignment: center;
        vertical-alignment: center;
        text: data.content;
        font-family: data.font.name;
        font-size: computed-content-fs;
    }

    if !data.is-logo && !data.verse.is-empty: Text {
        y: parent.height - computed-verse-fs - verse-bottom-offset;
        text: data.verse;
        color: data.verse-font.color;
        stroke: data.verse-font.stroke;
        stroke-width: computed-verse-stroke-width;
        stroke-style: outside;
        horizontal-alignment: center;
        vertical-alignment: center;
        font-family: data.verse-font.name;
        font-size: computed-verse-fs;
    }
}
